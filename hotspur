#!/bin/bash
function cleanup {
	conda deactivate
}

SCRIPT_DIR=$(dirname $(realpath $0))

if [ "$1" = "--env" ] || [ "$1" = "-e" ]; then
    ENV_FILE="$2"
    shift 2
else
    ENV_FILE="${SCRIPT_DIR}/hotspur_env.sh"
fi

source "$ENV_FILE"

# https://github.com/conda/conda/issues/7980
eval "$(conda shell.bash hook)"
conda activate "hotspur"
trap cleanup EXIT

python3 "${SCRIPT_DIR}/hotspur.py" ${@}

cleanup
